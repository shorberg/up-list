<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Reliable Superstore BDC Online Up List</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <style>
    :root {
      --bg:#f6f8fb; --card:#fff; --ink:#111; --muted:#5a6b7b;
      --ok:#1f9d55; --bad:#d64545; --line:#e6e9ef;
      --accent:#2f67ff; --row:#f0f5ff;
    }
    body { margin:0; background:var(--bg); color:var(--ink);
           font:14px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial }
    .wrap { max-width:1100px; margin:24px auto; padding:0 16px }
    header { display:flex; align-items:center; justify-content:space-between; margin-bottom:12px }
    h1 { font-size:22px; margin:0 }
    .sub { color:var(--muted); font-size:13px }
    .clock { font-weight:600 }
    .bar { display:flex; gap:8px; margin:12px 0 }
    input[type=text]{height:36px;padding:0 10px;border:1px solid var(--line);border-radius:8px;background:#fff;min-width:260px}
    button{height:36px;padding:0 12px;border:1px solid var(--line);border-radius:8px;background:#fff;cursor:pointer}
    button.primary{background:var(--accent);color:#fff;border-color:var(--accent)}
    button.warn{background:#fff3f3;border-color:#ffd4d4;color:#c92a2a}
    button.small{height:30px;font-size:12px;padding:0 10px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:12px;overflow:hidden}
    table{width:100%;border-collapse:collapse}
    thead th{background:#0f172a;color:#fff;font-weight:600;padding:10px;font-size:13px;text-align:left}
    tbody td{border-top:1px solid var(--line);padding:8px;vertical-align:middle}
    tr.up{background:var(--row)}
    .x-black { color:#000; font-weight:900; font-size:16px }
    .x-red { color:#d64545; font-weight:900; font-size:16px }
    .footer{margin-top:18px;display:grid;grid-template-columns:repeat(auto-fit,minmax(210px,1fr));gap:10px}
    .link{display:flex;gap:10px;align-items:center;justify-content:center;background:#fff;border:1px solid var(--line);border-radius:10px;height:48px}
    .muted{color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Reliable Superstore BDC Online Up List</h1>
        <div class="sub"><span id="today"></span> â€¢ <span class="clock" id="clock"></span></div>
      </div>
    </header>

    <div class="bar">
      <input id="nameInput" type="text" placeholder="Add team member name" />
      <button class="primary" id="addBtn">Add</button>
      <button id="nextBtn">Next Lead</button>
      <button id="resetBtn">Reset</button>
    </div>

    <div class="card">
      <table>
        <thead>
          <tr>
            <th style="width:44px">Order</th>
            <th style="width:220px">Name</th>
            <th style="width:90px">Status</th>
            <th style="width:50px">Up</th>
            <th style="width:80px">Makeups</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </div>

<script>
  // === CONFIG ===
  const SUPABASE_URL = "https://imfzlhudhljathvkgkqf.supabase.co";
  const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImltZnpsaHVkaGxqYXRodmtna3FmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc4MDAxMDUsImV4cCI6MjA3MzM3NjEwNX0.Bb-SUJMWfzVMHkdYuAgAD31wExcLuNazss6AJ11Z_VQ";
  const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  const el = (id) => document.getElementById(id);
  const tbody = el('tbody');
  const nameInput = el('nameInput');

  // Clock
  function tick(){
    const d = new Date();
    el('today').textContent = d.toLocaleDateString(undefined,{weekday:'long',month:'long',day:'numeric'});
    el('clock').textContent = d.toLocaleTimeString(undefined,{hour:'numeric',minute:'2-digit',second:'2-digit'});
  }
  setInterval(tick,1000); tick();

  // Fetch data
  async function fetchPeople(){
    const { data, error } = await supabase.from('people').select('*').order('order',{ascending:true});
    if(error){console.error(error);return []}
    return data;
  }

  // Render table
  function renderRows(rows){
    tbody.innerHTML = '';
    rows.forEach(p=>{
      const tr = document.createElement('tr');
      if(p.is_up) tr.classList.add('up');
      tr.innerHTML = `
        <td>${p.order}</td>
        <td>${p.name}</td>
        <td>${p.status}</td>
        <td>${p.is_up ? '<span class="x-black">X</span>' : ''}</td>
        <td>${p.makeups>0 ? '<span class="x-red">X</span>' : ''}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  // Add person
  async function addPerson(){
    const name = nameInput.value.trim();
    if(!name) return;
    await supabase.from('people').insert([{name, status:'Here'}]);
    nameInput.value = '';
  }

  el('addBtn').onclick = addPerson;

  // Auto refresh
  async function refresh(){
    const rows = await fetchPeople();
    renderRows(rows);
  }
  refresh();
  setInterval(refresh,5000);
</script>
</body>
</html>